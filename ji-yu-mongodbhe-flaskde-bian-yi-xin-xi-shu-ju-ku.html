
<!DOCTYPE html>
<html lang="cn"
>
<head>
    <title>基于MongoDB和Flask的变异信息数据库 - Café de Lyon</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="wb:webmaster" content="3cba1a80be39e3a2" />



<link rel="canonical" href="http://www.lyon0804.com/ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku.html">

        <meta name="author" content="lyon" />
        <meta name="keywords" content="bioinformatics,MongoDB,Flask,variant database" />
        <meta name="description" content="临床变异数据库 当积累的一定的样本量之后, 就应该积累自己的数据库, 建立变异数据库的意义在于: 样品管理; 变异数据搜集, 以及应用该数据库注释新的变异; 变异数据库的建立不应该脱离表型, 结合LIMS系统中提供的样品信息, 可以结合表型和基因型; 读取VCF文件中的变异信息 在构建变异数据库时, 不应该建立在已有注释的前提之下, 所以数据库应该以calling的VCF结果为起点; 为了保证VCF文件中的变异条目具有唯一表示, 在录入之前必须先进行标准化处理; 以下是VCF文件的读取实现: import vcf # 自己实现的VariantRecord类, 其中包含变异标准化方法 from lib.variant import VariantRecord def vcf_reader(file_name): result_list = [] with open(file_name, encoding=&#39;utf-8&#39;) as fp: reader = vcf.Reader(fp, &#39;r&#39;) for record in reader: for alt in ..." />

        <meta property="og:site_name" content="Café de Lyon" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="基于MongoDB和Flask的变异信息数据库"/>
        <meta property="og:url" content="http://www.lyon0804.com/ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku.html"/>
        <meta property="og:description" content="临床变异数据库 当积累的一定的样本量之后, 就应该积累自己的数据库, 建立变异数据库的意义在于: 样品管理; 变异数据搜集, 以及应用该数据库注释新的变异; 变异数据库的建立不应该脱离表型, 结合LIMS系统中提供的样品信息, 可以结合表型和基因型; 读取VCF文件中的变异信息 在构建变异数据库时, 不应该建立在已有注释的前提之下, 所以数据库应该以calling的VCF结果为起点; 为了保证VCF文件中的变异条目具有唯一表示, 在录入之前必须先进行标准化处理; 以下是VCF文件的读取实现: import vcf # 自己实现的VariantRecord类, 其中包含变异标准化方法 from lib.variant import VariantRecord def vcf_reader(file_name): result_list = [] with open(file_name, encoding=&#39;utf-8&#39;) as fp: reader = vcf.Reader(fp, &#39;r&#39;) for record in reader: for alt in ..."/>
        <meta property="article:published_time" content="2016-09-21" />
            <meta property="article:section" content="bioinformatics" />
            <meta property="article:tag" content="bioinformatics" />
            <meta property="article:tag" content="MongoDB" />
            <meta property="article:tag" content="Flask" />
            <meta property="article:tag" content="variant database" />
            <meta property="article:author" content="lyon" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.lyon0804.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://www.lyon0804.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.lyon0804.com/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://www.lyon0804.com/theme/css/style.css" type="text/css"/>

        <link href="http://www.lyon0804.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Café de Lyon ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.lyon0804.com/" class="navbar-brand">
<img src="http://www.lyon0804.com/static/img/logo.png" width="30px"/> Café de Lyon            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="http://www.lyon0804.com/category/bioinformatics.html">Bioinformatics</a>
                        </li>
                        <li >
                            <a href="http://www.lyon0804.com/category/learning.html">Learning</a>
                        </li>
                        <li >
                            <a href="http://www.lyon0804.com/category/pages.html">Pages</a>
                        </li>
                        <li >
                            <a href="http://www.lyon0804.com/category/photo.html">Photo</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://www.lyon0804.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://www.lyon0804.com/ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku.html"
                       rel="bookmark"
                       title="Permalink to 基于MongoDB和Flask的变异信息数据库">
                        基于MongoDB和Flask的变异信息数据库
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-09-21T00:00:00+08:00"> Wed 21 September 2016</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://www.lyon0804.com/tag/bioinformatics.html">bioinformatics</a>
        /
	<a href="http://www.lyon0804.com/tag/mongodb.html">MongoDB</a>
        /
	<a href="http://www.lyon0804.com/tag/flask.html">Flask</a>
        /
	<a href="http://www.lyon0804.com/tag/variant-database.html">variant database</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h2>临床变异数据库</h2>
<p>当积累的一定的样本量之后, 就应该积累自己的数据库, 建立变异数据库的意义在于:</p>
<ol>
<li>样品管理;</li>
<li>变异数据搜集, 以及应用该数据库注释新的变异;</li>
</ol>
<p>变异数据库的建立不应该脱离表型, 结合LIMS系统中提供的样品信息, 可以结合表型和基因型;</p>
<h2>读取VCF文件中的变异信息</h2>
<p>在构建变异数据库时, 不应该建立在已有注释的前提之下, 所以数据库应该以calling的VCF结果为起点;</p>
<p>为了保证VCF文件中的变异条目具有唯一表示, 在录入之前必须先进行<a href="http://www.lyon0804.com/fan-yi-variant-normalization.html">标准化处理</a>;</p>
<p>以下是VCF文件的读取实现:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">vcf</span>
<span class="c"># 自己实现的VariantRecord类, 其中包含变异标准化方法</span>
<span class="kn">from</span> <span class="nn">lib.variant</span> <span class="kn">import</span> <span class="n">VariantRecord</span>

<span class="k">def</span> <span class="nf">vcf_reader</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">vcf</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">alt</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">ALT</span><span class="p">:</span>
                <span class="n">variant</span> <span class="o">=</span> <span class="n">VariantRecord</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">CHROM</span><span class="p">),</span> <span class="n">record</span><span class="o">.</span><span class="n">POS</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">REF</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">alt</span><span class="p">))</span>
                <span class="n">variant</span><span class="o">.</span><span class="n">normalization</span><span class="p">()</span>
                <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s">&#39;CHROM&#39;</span><span class="p">:</span> <span class="n">variant</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span>
                    <span class="s">&#39;POS&#39;</span><span class="p">:</span> <span class="n">variant</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span>
                    <span class="s">&#39;ID&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span>
                    <span class="s">&#39;REF&#39;</span><span class="p">:</span> <span class="n">variant</span><span class="o">.</span><span class="n">ref</span><span class="p">,</span>
                    <span class="s">&#39;ALT&#39;</span><span class="p">:</span> <span class="n">variant</span><span class="o">.</span><span class="n">alt</span><span class="p">,</span>
                    <span class="s">&#39;FILTER&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">FILTER</span><span class="p">,</span>
                    <span class="s">&#39;QUAL&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">QUAL</span><span class="p">,</span>
                    <span class="s">&#39;INFO&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                    <span class="s">&#39;GT&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">GT</span><span class="p">,</span>
                    <span class="s">&#39;AD&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
                    <span class="s">&#39;DP&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DP</span><span class="p">,</span>
                    <span class="s">&#39;GQ&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">GQ</span><span class="p">,</span>
                    <span class="s">&#39;PL&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PL</span><span class="p">,</span>
                <span class="p">})</span>
    <span class="k">return</span> <span class="n">result_list</span>
</pre></div>


<h2>录入变异信息到MongoDB</h2>
<p>首先在mongo下建立数据库以及新增用户;</p>
<div class="highlight"><pre>&gt; use variant_info
&gt; db.addUser(&#39;user&#39;, &#39;123&#39;, true)
&gt; db.addUser(&#39;admin&#39;, &#39;123&#39;)
</pre></div>


<p>只有VCF文件难以对应到具体的样品, 所以在VCF信息录入时, 添加相应的样品信息, 并方便通过样品条码号等调用lims中的表型信息;</p>
<p>以下提供一个插入的示例, <em>.seq</em>文件是记录一些样品测序信息的tsv文件.</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s">&#39;xxxx&#39;</span><span class="p">,</span> <span class="n">xxx</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">admin_acquire</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;admin&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;123&#39;</span><span class="p">)</span>
        <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;123&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>


<span class="k">class</span> <span class="nc">Germline</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">variant_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;user&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">&#39;123&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">germline</span>

    <span class="k">def</span> <span class="nf">create_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">## 按照具体查询需求建立索引</span>

    <span class="nd">@admin_acquire</span>
    <span class="k">def</span> <span class="nf">db_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq_date</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c">## 一个插入示例,     </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_index</span><span class="p">()</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">.seq&quot;</span> <span class="o">%</span> <span class="n">seq_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
            <span class="n">Row</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Row&#39;</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>
                <span class="n">row</span><span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq_date</span>
                <span class="n">seq_reg_date</span> <span class="o">=</span> <span class="n">seq_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="n">seq_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;seq_name&#39;</span><span class="p">]</span>
                <span class="n">vcf_file</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;/bio01/database/VariantCalling/germline/vcf_filtered/&quot;</span>
                            <span class="s">&quot;{seq_reg_date}/{seq_name}.filtered.vcf&quot;</span>
                            <span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="nb">vars</span><span class="p">()))</span>
                <span class="n">calling_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf_reader</span><span class="p">(</span><span class="n">vcf_file</span><span class="p">)</span>
                <span class="n">document</span> <span class="o">=</span> <span class="n">row</span>
                <span class="n">document</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;calling_result&#39;</span><span class="p">:</span> <span class="n">calling_result</span><span class="p">})</span>
                <span class="n">try_find</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s">&#39;seq_date&#39;</span><span class="p">:</span> <span class="n">seq_date</span><span class="p">,</span> <span class="s">&#39;seq_name&#39;</span><span class="p">:</span> <span class="n">seq_name</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">try_find</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">update</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;_id&#39;</span><span class="p">:</span> <span class="n">try_find</span><span class="p">[</span><span class="s">&#39;_id&#39;</span><span class="p">]},</span> <span class="n">document</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
</pre></div>


<h2>通用查询接口</h2>
<p>变异数据库查询时, 若所需的结果格式相同, 则可以通过一个简单的方法, 以便处理来自所有不同字段的查询;</p>
<p>当某种类型的查询比较频繁时, 可以针对性建立index来加速查询;</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">Germline</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c">## 续上类</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_query</span><span class="p">(</span><span class="n">query_result</span><span class="p">):</span>
        <span class="n">search_results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">show_item</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">,</span> <span class="s">&#39;seq_name&#39;</span><span class="p">,</span> <span class="s">&#39;sample_name&#39;</span><span class="p">,</span> <span class="s">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s">&#39;seq_kit&#39;</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">sort_key</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;sample_name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">query_result</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="s">&#39;NA&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">show_item</span><span class="p">}</span>
            <span class="n">search_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">query_result</span><span class="p">:</span>
            <span class="n">q</span><span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">show_item</span><span class="p">}</span>
            <span class="n">search_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">search_results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">sort_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">search_results</span>

    <span class="k">def</span> <span class="nf">auto_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">binding_items</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;sample_name&#39;</span><span class="p">:</span> <span class="s">&#39;sample_name&#39;</span><span class="p">,</span>
            <span class="s">&#39;sample_id&#39;</span><span class="p">:</span> <span class="s">&#39;sample_id&#39;</span><span class="p">,</span>
            <span class="s">&#39;seq_kit&#39;</span><span class="p">:</span> <span class="s">&#39;seq_kit&#39;</span><span class="p">,</span>
            <span class="s">&#39;seq_date&#39;</span><span class="p">:</span> <span class="s">&#39;seq_date&#39;</span><span class="p">,</span>
            <span class="s">&#39;CHROM&#39;</span><span class="p">:</span> <span class="s">&#39;calling_result.CHROM&#39;</span><span class="p">,</span>
            <span class="s">&#39;POS&#39;</span><span class="p">:</span> <span class="s">&#39;calling_result.POS&#39;</span><span class="p">,</span>
            <span class="s">&#39;REF&#39;</span><span class="p">:</span> <span class="s">&#39;calling_result.REF&#39;</span><span class="p">,</span>
            <span class="s">&#39;ALT&#39;</span><span class="p">:</span> <span class="s">&#39;calling_result.ALT&#39;</span><span class="p">,</span>
            <span class="s">&#39;ID&#39;</span><span class="p">:</span> <span class="s">&#39;calling_result.ID&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">search_key</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">binding_items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">search_key</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">search_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_query</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>


<p>当需要多种结果格式时, 可以在此基础上再做封装;</p>
<h2>使用Flask提供API</h2>
<p>后台选择使用Flask来提供web api, 下面是一个实现示例:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">jsonify</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/seq_info&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;POST&#39;</span><span class="p">,</span> <span class="s">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">seq_info</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="s">&#39;POS&#39;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">item</span><span class="p">[</span><span class="s">&#39;POS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&#39;POS&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s">&#39;seq_date&#39;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">item</span><span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&#39;seq_date&#39;</span><span class="p">],</span> <span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">database.variant_info</span> <span class="kn">import</span> <span class="n">Germline</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Germline</span><span class="p">()</span>
        <span class="n">search_result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">auto_query</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">seq_info</span><span class="o">=</span><span class="n">search_result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;seq_info.html&#39;</span><span class="p">)</span>
</pre></div>


<h2>使用Ajax查询结果并展示</h2>
<p>整个页面的设计比较简单, 主要就通过一个Ajax来调用api, 然后返回结果展示;</p>
<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;UTF-8&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>查询变异信息<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;</span>
            <span class="na">integrity=</span><span class="s">&quot;sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=&quot;</span> <span class="na">crossorigin=</span><span class="s">&quot;anonymous&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result_function</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">//error handling code here</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
                        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">seq_info</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#result_table&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;&lt;tr/&gt;&#39;</span><span class="p">);</span>
                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">seq_info</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">seq_date</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s2">&quot;#result_table tr:last&quot;</span><span class="p">);</span>
                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">seq_info</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">seq_name</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s2">&quot;#result_table tr:last&quot;</span><span class="p">);</span>
                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">seq_info</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">sample_name</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s2">&quot;#result_table tr:last&quot;</span><span class="p">);</span>
                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">seq_info</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">sample_id</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s2">&quot;#result_table tr:last&quot;</span><span class="p">);</span>
                            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">seq_info</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">seq_kit</span> <span class="o">+</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s2">&quot;#result_table tr:last&quot;</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">};</span>
        <span class="kd">var</span> <span class="nx">get_item</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key_name</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">search_key</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">key_name</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">search_key</span><span class="p">).</span><span class="nx">val</span><span class="p">().</span><span class="nx">trim</span><span class="p">();</span>
        <span class="p">};</span>
        <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">keydown</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#submit&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
                <span class="k">return</span> <span class="kc">false</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#submit&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#result_content&quot;</span><span class="p">).</span><span class="nx">empty</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
            <span class="nx">req</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">result_function</span><span class="p">(</span><span class="nx">req</span><span class="p">);</span>
            <span class="nx">req</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;{{ url_for(&quot;seq_info&quot;) }}&#39;</span><span class="p">);</span>
            <span class="nx">req</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;Content-type&quot;</span><span class="p">,</span> <span class="s2">&quot;application/x-www-form-urlencoded&quot;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">search_keys</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;sample_name&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_id&#39;</span><span class="p">,</span> <span class="s1">&#39;seq_kit&#39;</span><span class="p">,</span> <span class="s1">&#39;seq_date&#39;</span><span class="p">,</span>
                <span class="s1">&#39;CHROM&#39;</span><span class="p">,</span> <span class="s1">&#39;POS&#39;</span><span class="p">,</span> <span class="s1">&#39;REF&#39;</span><span class="p">,</span> <span class="s1">&#39;ALT&#39;</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span>
            <span class="p">];</span>
            <span class="kd">var</span> <span class="nx">postVars</span> <span class="o">=</span> <span class="s1">&#39;secret=&#39;</span> <span class="o">+</span> <span class="nx">get_item</span><span class="p">(</span><span class="s1">&#39;secret&#39;</span><span class="p">);</span>
            <span class="nx">search_keys</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">get_item</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">postVars</span> <span class="o">+=</span> <span class="s1">&#39;&amp;&#39;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>
            <span class="nx">req</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">postVars</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">false</span>
        <span class="p">});</span>
    <span class="p">})</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;center&gt;</span>

    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">method=</span><span class="s">&quot;POST&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;</span>
            快速查询方式1：
            <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;span&gt;</span>样品名称：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;sample_name&quot;</span> <span class="na">id=</span><span class="s">&quot;sample_name&quot;</span> <span class="na">title=</span><span class="s">&quot;样品名称&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;</span>
            快速查询方式2:
            <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;span&gt;</span>染色体编号：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;CHROM&quot;</span> <span class="na">id=</span><span class="s">&quot;CHROM&quot;</span> <span class="na">title=</span><span class="s">&quot;染色体编号&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;span&gt;</span>染色体位置：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;number&quot;</span> <span class="na">name=</span><span class="s">&quot;POS&quot;</span> <span class="na">id=</span><span class="s">&quot;POS&quot;</span> <span class="na">title=</span><span class="s">&quot;染色体位置&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;span&gt;</span>REF: <span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;REF&quot;</span> <span class="na">id=</span><span class="s">&quot;REF&quot;</span> <span class="na">title=</span><span class="s">&quot;REF&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;span&gt;</span>ALT: <span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;ALT&quot;</span> <span class="na">id=</span><span class="s">&quot;ALT&quot;</span> <span class="na">title=</span><span class="s">&quot;ALT&quot;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;p&gt;</span>
            普通查询方式（若包含以下查询项，则查询速度会较慢）：
        <span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;span&gt;</span>变异ID（早期样品无法通过该项查找）：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;ID&quot;</span> <span class="na">id=</span><span class="s">&quot;ID&quot;</span> <span class="na">title=</span><span class="s">&quot;变异ID&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;span&gt;</span>条码号：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;sample_id&quot;</span> <span class="na">id=</span><span class="s">&quot;sample_id&quot;</span> <span class="na">title=</span><span class="s">&quot;条码号&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;span&gt;</span>测序试剂盒：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;seq_kit&quot;</span> <span class="na">id=</span><span class="s">&quot;seq_kit&quot;</span> <span class="na">title=</span><span class="s">&quot;测序试剂盒&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;span&gt;</span>测序日期（%Y-%m-%d格式）：<span class="nt">&lt;/span&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;datetime&quot;</span> <span class="na">name=</span><span class="s">&quot;seq_date&quot;</span> <span class="na">id=</span><span class="s">&quot;seq_date&quot;</span> <span class="na">title=</span><span class="s">&quot;测序日期&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;br&gt;</span>

        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name=</span><span class="s">&quot;secret&quot;</span> <span class="na">id=</span><span class="s">&quot;secret&quot;</span> <span class="na">value=</span><span class="s">&quot;shhh&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;查询&quot;</span> <span class="na">id=</span><span class="s">&quot;submit&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;myDiv&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;table</span> <span class="na">id=</span><span class="s">&quot;result_table&quot;</span> <span class="na">border=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">width=</span><span class="s">&quot;200px&quot;</span><span class="nt">&gt;</span>测序时间<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">width=</span><span class="s">&quot;200px&quot;</span><span class="nt">&gt;</span>测序样品名<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">width=</span><span class="s">&quot;200px&quot;</span><span class="nt">&gt;</span>样品名<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">width=</span><span class="s">&quot;200px&quot;</span><span class="nt">&gt;</span>条码号<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th</span> <span class="na">width=</span><span class="s">&quot;200px&quot;</span><span class="nt">&gt;</span>试剂盒<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
            <span class="nt">&lt;/thead&gt;</span>
            <span class="nt">&lt;tbody</span> <span class="na">id=</span><span class="s">&quot;result_content&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/tbody&gt;</span>
        <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<h2>最终实现</h2>
<p><img alt="实现结果" src="http://ww3.sinaimg.cn/large/95202659jw1f81c8kamq5j21vy0tkn1x.jpg" /></p>
<p>该网页对外实现的功能有:</p>
<ol>
<li>通过样品信息查询测序情况;</li>
<li>通过变异位点, 查询曾经出现过相同变异的样品;</li>
</ol>
            </div>
            <!-- /.entry-content -->

    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>
<!--         <div class="ds-thread" data-thread-key="ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku" data-title="基于MongoDB和Flask的变异信息数据库" data-url="http://www.lyon0804.com/ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku.html"></div> -->
		<script type="text/javascript">
     		var duoshuoQuery = {short_name:"lyon0804"};
    		(function() {
    			var ds = document.createElement('script');
    			ds.type = 'text/javascript';ds.async = true;
    			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    			ds.charset = 'UTF-8';
    			(document.getElementsByTagName('head')[0]
    			 || document.getElementsByTagName('body')[0]).appendChild(ds);
    		})();
    	</script>
        <script type="text/javascript">
            function toggleDuoshuoComments(container, id, title, url){
                if(jQuery(container).has("div").length>0){
                    jQuery(container).empty();
                    return;
                }
                var el = document.createElement('div');
                el.setAttribute('class','ds-thread');
                el.setAttribute('data-thread-key', id);
                el.setAttribute('data-title',title);
                el.setAttribute('data-url', url);
                DUOSHUO.EmbedThread(el);
                jQuery(container).append(el);
            }
        </script>
        <a href="javascript:void(0);" onclick="toggleDuoshuoComments('#comment-box', 'ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku', '基于MongoDB和Flask的变异信息数据库' , 'http://www.lyon0804.com/ji-yu-mongodbhe-flaskde-bian-yi-xin-xi-shu-ju-ku.html');">
        查看评论</a>
        <div id="comment-box" ></div>
        <hr/>
    	<noscript>Please enable JavaScript to view the <a href="http://duoshuo.com/">comments powered by
        Duoshuo.</a></noscript>
    	<a href="http://duoshuo.com" class="dsq-brlink">comments powered by <span>Duoshuo</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
            <!-- <div class="list-group-item"> -->
            <!-- <h4> -->
            <!-- <i class="fa fa-home fa-lg"></i> -->
            <!-- <span class="icon-label">Social</span></h4> -->
              <ul class="list-group" id="social">
                   <!-- <li class="list-group-item"> -->
                   <div class="social-item">
                   <a href="http://github.com/lozybean">
                     <i class="fa fa-github-square fa-lg"></i><!--  github -->
                   </a>
                   </div>
                   <!-- </li> -->
                   <!-- <li class="list-group-item"> -->
                   <div class="social-item">
                   <a href="http://weibo.com/lyon0804">
                     <i class="fa fa-weibo fa-lg"></i><!--  weibo -->
                   </a>
                   </div>
                   <!-- </li> -->
              </ul>
            <!-- </div> -->
         <div class="col-xs-10">&copy; 2016 lyon
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3(modified by lyon)</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2" id="back-top">
            <!-- <p class="pull-right"><i class="fa fa-arrow-up"></i>  -->
            <a href="#top" title="回到顶部"></a>
            </p>
         </div>
      </div>
   </div>
</footer>
<script src="http://www.lyon0804.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.lyon0804.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.lyon0804.com/theme/js/respond.min.js"></script>


</body>
</html>