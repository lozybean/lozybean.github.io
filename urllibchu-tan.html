
<!DOCTYPE html>
<html lang="cn"
>
<head>
    <title>urllib初探 - Café de Lyon</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="wb:webmaster" content="3cba1a80be39e3a2" />



<link rel="canonical" href="http://www.lyon0804.com/urllibchu-tan.html">

        <meta name="author" content="lyon" />
        <meta name="keywords" content="python,urllib,http" />
        <meta name="description" content="urllib是一个Python的内置库，用来完成url相关的相关处理，最主要的功能就是使用通过url来完成请求。常用但不限于HTTP协议。 Python2.x和Python3.x的区别 在Python2.x中，有两个不同的模块： urllib : 只能通过一个url来发出请求，提供urlencode函数生成GET的查询字符串； urllib2 : 可以通过Request对象来发出请求，支持添加各种头部，意味着可以伪装成各种浏览器。没有urlencode函数； 而在Python3.x中，这两个模块以及urlparse、robotparser一共四个模块合并为一个urllib模块，并且按照不同的功能分成5个子模块： urllib.error : 定义一些异常类； urllib.parse : 完成url的解析工作，将一个url分解成不同部分； urllib.request : 通过Request对象发出请求，另外一个请求方式被废除； urllib.response : 针对获取到的响应设计的文件类接口，可以用处理文件的形式处理响应； urllib.robotparser : 解析robotstxt，文件相关定义参考官方文档； 使用urllib发送HTTP请求 使用Python3.x的urllib模块来发送简单的HTTP请求，Python2.x对应之前的各个模块，以 ..." />

        <meta property="og:site_name" content="Café de Lyon" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="urllib初探"/>
        <meta property="og:url" content="http://www.lyon0804.com/urllibchu-tan.html"/>
        <meta property="og:description" content="urllib是一个Python的内置库，用来完成url相关的相关处理，最主要的功能就是使用通过url来完成请求。常用但不限于HTTP协议。 Python2.x和Python3.x的区别 在Python2.x中，有两个不同的模块： urllib : 只能通过一个url来发出请求，提供urlencode函数生成GET的查询字符串； urllib2 : 可以通过Request对象来发出请求，支持添加各种头部，意味着可以伪装成各种浏览器。没有urlencode函数； 而在Python3.x中，这两个模块以及urlparse、robotparser一共四个模块合并为一个urllib模块，并且按照不同的功能分成5个子模块： urllib.error : 定义一些异常类； urllib.parse : 完成url的解析工作，将一个url分解成不同部分； urllib.request : 通过Request对象发出请求，另外一个请求方式被废除； urllib.response : 针对获取到的响应设计的文件类接口，可以用处理文件的形式处理响应； urllib.robotparser : 解析robotstxt，文件相关定义参考官方文档； 使用urllib发送HTTP请求 使用Python3.x的urllib模块来发送简单的HTTP请求，Python2.x对应之前的各个模块，以 ..."/>
        <meta property="article:published_time" content="2015-10-28" />
            <meta property="article:section" content="Learning" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="urllib" />
            <meta property="article:tag" content="http" />
            <meta property="article:author" content="lyon" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.lyon0804.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://www.lyon0804.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.lyon0804.com/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://www.lyon0804.com/theme/css/style.css" type="text/css"/>

        <link href="http://www.lyon0804.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Café de Lyon ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.lyon0804.com/" class="navbar-brand">
<img src="http://www.lyon0804.com/static/img/logo.png" width="30px"/> Café de Lyon            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="http://www.lyon0804.com/category/bioimformatics.html">Bioimformatics</a>
                        </li>
                        <li class="active">
                            <a href="http://www.lyon0804.com/category/learning.html">Learning</a>
                        </li>
                        <li >
                            <a href="http://www.lyon0804.com/category/pages.html">Pages</a>
                        </li>
                        <li >
                            <a href="http://www.lyon0804.com/category/photo.html">Photo</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://www.lyon0804.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://www.lyon0804.com/urllibchu-tan.html"
                       rel="bookmark"
                       title="Permalink to urllib初探">
                        urllib初探
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-10-28T00:00:00+08:00"> Wed 28 October 2015</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://www.lyon0804.com/tag/python.html">python</a>
        /
	<a href="http://www.lyon0804.com/tag/urllib.html">urllib</a>
        /
	<a href="http://www.lyon0804.com/tag/http.html">http</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><code>urllib</code>是一个Python的内置库，用来完成url相关的相关处理，最主要的功能就是使用通过url来完成请求。常用但不限于HTTP协议。</p>
<h2>Python2.x和Python3.x的区别</h2>
<p>在Python2.x中，有两个不同的模块：</p>
<ul>
<li>urllib : 只能通过一个url来发出请求，提供urlencode函数生成GET的查询字符串；</li>
<li>urllib2 : 可以通过Request对象来发出请求，支持添加各种头部，意味着可以伪装成各种浏览器。没有urlencode函数；</li>
</ul>
<p>而在Python3.x中，这两个模块以及urlparse、robotparser一共四个模块合并为一个urllib模块，并且按照不同的功能分成5个子模块：</p>
<ul>
<li>urllib.error : 定义一些异常类；</li>
<li>urllib.parse : 完成url的解析工作，将一个url分解成不同部分；</li>
<li>urllib.request : 通过Request对象发出请求，另外一个请求方式被废除；</li>
<li>urllib.response : 针对获取到的响应设计的文件类接口，可以用处理文件的形式处理响应；</li>
<li>urllib.robotparser : 解析robotstxt，文件相关定义参考<a href="http://www.robotstxt.org/orig.html">官方文档</a>；</li>
</ul>
<h2>使用urllib发送HTTP请求</h2>
<p>使用Python3.x的urllib模块来发送简单的HTTP请求，Python2.x对应之前的各个模块，以<code>GET</code>和<code>POST</code>为例；</p>
<h2>1. 发送GET请求获取weibo主页</h2>
<p>先看代码:</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*- #</span>

<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;http://weibo.com&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;GET&#39;</span><span class="p">)</span>
<span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span>
    <span class="s">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s">&#39;application/x-www-form-urlencoded;charset=utf-8&#39;</span><span class="p">)</span>
<span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span>
    <span class="s">&#39;User-Agent&#39;</span><span class="p">,</span>
    <span class="s">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_0) AppleWebKit/601.1.56 (KHTML, like Gecko) Version/9.0 Safari/601.1.56&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;sina_index.html&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">head_line</span> <span class="o">=</span> <span class="s">&#39;HTTP/</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="se">\r\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">version</span> <span class="o">/</span> <span class="mi">10</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
    <span class="n">real_url</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">url</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="n">head_line</span> <span class="o">+</span> <span class="n">headers</span><span class="p">)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>


<p>其中进行的一些主要步骤为：</p>
<ol>
<li>新建<code>Request()</code>对象，指定url以及需要使用的方法，可以通过header参数来传递HTTP首部；</li>
<li>使用<code>add_header()</code>方法，逐一添加需要的HTTP首部，主要是<code>User-Agent</code>必须指定一个浏览器类型，否则容易被网站屏蔽；</li>
<li>使用<code>request.urlopen()</code>方法，发送请求，并将响应作为文件形式进行操作；</li>
<li>打印响应的首部，并将响应实体写入到文件中；</li>
</ol>
<p>使用<code>Safari</code>的用户代理工具可以轻松获取浏览器类型代码：</p>
<ol>
<li>选择一个浏览器类型；</li>
<li>再选择其他，Safari会将当前浏览器的类型代码显示出来；</li>
</ol>
<p>最后打印的响应首部为：</p>
<div class="highlight"><pre><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="o">:</span> <span class="l">nginx</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Tue, 27 Oct 2015 17:30:08 GMT</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">text/html</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Vary</span><span class="o">:</span> <span class="l">Accept-Encoding</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-cache, must-revalidate</span>
<span class="na">Expires</span><span class="o">:</span> <span class="l">Sat, 26 Jul 1997 05:00:00 GMT</span>
<span class="na">Pragma</span><span class="o">:</span> <span class="l">no-cache</span>
<span class="na">Pragma</span><span class="o">:</span> <span class="l">no-cache</span>
<span class="na">DPOOL_HEADER</span><span class="o">:</span> <span class="l">dryad39</span>
<span class="na">SINA-LB</span><span class="o">:</span> <span class="l">aGEuOTEuZzEucXhnLmxiLnNpbmFub2RlLmNvbQ==</span>
<span class="na">SINA-TS</span><span class="o">:</span> <span class="l">ZDZjYTk0Y2UgMCAwIDAgNiAxMQo=</span>
</pre></div>


<h2>2. 使用Cookie登陆</h2>
<p>由于HTTP是无状态协议，网页服务如果需要管理一个<code>Session</code>(会话)，则势必要使用<code>Cookie</code>，以弥补HTTP的无状态缺点，利用这个特点，只需要在借助浏览器先完成一次登陆，然后获取Cookie，并使用Cookie来完成登陆。</p>
<p>获取Cookie的方式非常简单，通过<code>Chrome</code>浏览器自带的开发者工具就可以完成。</p>
<p>首先成功登陆微博，等待一会，完成本次连接的全部内容，然后调出开发者工具，并且选择Network选项卡：</p>
<p><img alt="步骤1" src="http://ww3.sinaimg.cn/large/95202659gw1exh7w0ayjzj21ha0rcjwe.jpg" /></p>
<p>接下来刷新页面，此时，浏览器发送Cookie来完成验证：</p>
<p><img alt="步骤2" src="http://ww4.sinaimg.cn/large/95202659gw1exh7w1ark9j21hc0u0gwd.jpg" /></p>
<p>在Network选项卡中，会把本次浏览器的连接过程按照时间先后排序后列出，第一个时间点但是是重新登陆验证了，所以右击这次连接，可以看到复制Request头以及Response头等各种选项，获取Cookie需要Request头，复制并且粘贴：</p>
<div class="highlight"><pre><span class="nf">GET</span> <span class="nn">/lyon0804/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">weibo.com</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, sdch</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">*****</span>
</pre></div>


<p>由于Cookie包含会话的认证信息，所以不要向他人公开Cookie，将上述请求头写到程序中，再次发送请求。</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*- #</span>

<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>

<span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;Host&#39;</span><span class="p">:</span> <span class="s">&#39;weibo.com&#39;</span><span class="p">,</span>
    <span class="s">&#39;Connection&#39;</span><span class="p">:</span> <span class="s">&#39;keep-alive&#39;</span><span class="p">,</span>
    <span class="s">&#39;Accept&#39;</span><span class="p">:</span>
    <span class="s">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39;</span><span class="p">,</span>
    <span class="s">&#39;Upgrade-Insecure-Requests&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&#39;User-Agent&#39;</span><span class="p">:</span>
    <span class="s">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36&#39;</span><span class="p">,</span>
    <span class="s">&#39;Accept-Encoding&#39;</span><span class="p">:</span> <span class="s">&#39;gzip, deflate, sdch&#39;</span><span class="p">,</span>
    <span class="s">&#39;Accept-Language&#39;</span><span class="p">:</span> <span class="s">&#39;zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4&#39;</span><span class="p">,</span>
    <span class="s">&#39;Cookie&#39;</span><span class="p">:</span><span class="s">&#39;*****&#39;</span>
<span class="p">}</span>
<span class="n">req</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;http://weibo.com&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;GET&#39;</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>

<span class="k">with</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;sina_home.html.gz&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>


<p>注意本次连接时，为了减轻IO压力，传输了压缩的内容，下载后，需要通过<code>gzip -cd sina_home.html.gz &gt;sina_home.html</code>命令解压该文件，登陆成功，但是注意下载的只是个人首页的网页框架，并不是全部内容，新鲜事这类的，需要通过解析其他的内容才能完成。</p>
<h2>3. 使用POST命令模拟微博表单登陆</h2>
<p>pc端的微博登陆页面有些复杂，先看相对简单的<a href="https://passport.weibo.cn/signin/login">移动端微博登陆页面</a>，参考<a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001432688314740a0aed473a39f47b09c8c7274c9ab6aee000">廖雪峰的Python教程</a>：</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span><span class="p">,</span> <span class="n">parse</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Login to weibo.cn...&#39;</span><span class="p">)</span>
<span class="n">email</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Email: &#39;</span><span class="p">)</span>
<span class="n">passwd</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Password: &#39;</span><span class="p">)</span>
<span class="n">login_data</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">([</span>
    <span class="p">(</span><span class="s">&#39;username&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;password&#39;</span><span class="p">,</span> <span class="n">passwd</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;entry&#39;</span><span class="p">,</span> <span class="s">&#39;mweibo&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;client_id&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;savestate&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;ec&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;pagerefer&#39;</span><span class="p">,</span> <span class="s">&#39;https://passport.weibo.cn/signin/welcome?entry=mweibo&amp;r=http%3A</span><span class="si">%2F%2F</span><span class="s">m.weibo.cn</span><span class="si">%2F</span><span class="s">&#39;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="s">&#39;https://passport.weibo.cn/sso/login&#39;</span><span class="p">)</span>
<span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">&#39;Origin&#39;</span><span class="p">,</span> <span class="s">&#39;https://passport.weibo.cn&#39;</span><span class="p">)</span>
<span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">&#39;User-Agent&#39;</span><span class="p">,</span> <span class="s">&#39;Mozilla/6.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/8.0 Mobile/10A5376e Safari/8536.25&#39;</span><span class="p">)</span>
<span class="n">req</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">&#39;Referer&#39;</span><span class="p">,</span> <span class="s">&#39;https://passport.weibo.cn/signin/login?entry=mweibo&amp;res=wel&amp;wm=3349&amp;r=http%3A</span><span class="si">%2F%2F</span><span class="s">m.weibo.cn</span><span class="si">%2F</span><span class="s">&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">login_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Status:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">getheaders</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Data:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>


<p>这一个过程没有弄很明白，先记录一下，等待之后解决：</p>
<ol>
<li>如何获取表单所需要的信息；</li>
<li>该表单中密码使用了明文的方式，是否存在安全问题；</li>
<li>使用了Referer头部来指定原始URI，是否存在安全问题，和上一条一样，是否是由<code>HTTPS</code>来保证安全出传输；</li>
</ol>
<h2>问题解决(持续更新)</h2>
<p>首先解决之前留下的三个问题：</p>
<ol>
<li>如何获取表单内容，使用Firefox浏览器，并安装HTTPfox插件，即可跟踪消息记录，获取到POST的内容，其中就有表单信息；</li>
<li>明文密码的安全问题，还没有搞清楚，但是可以肯定的是建立在SSL或者TSL的安全通道基础上，防止被第三方截获；</li>
<li>Referer首部，使用POST方法时，该首部不含有账号密码的信息，更加重要的是，网站为了验证是否由站点自身发起，加入首部可以伪装成站点自身；</li>
</ol>
            </div>
            <!-- /.entry-content -->

    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>
<!--         <div class="ds-thread" data-thread-key="urllibchu-tan" data-title="urllib初探" data-url="http://www.lyon0804.com/urllibchu-tan.html"></div> -->
		<script type="text/javascript">
     		var duoshuoQuery = {short_name:"lyon0804"};
    		(function() {
    			var ds = document.createElement('script');
    			ds.type = 'text/javascript';ds.async = true;
    			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    			ds.charset = 'UTF-8';
    			(document.getElementsByTagName('head')[0]
    			 || document.getElementsByTagName('body')[0]).appendChild(ds);
    		})();
    	</script>
        <script type="text/javascript">
            function toggleDuoshuoComments(container, id, title, url){
                if(jQuery(container).has("div").length>0){
                    jQuery(container).empty();
                    return;
                }
                var el = document.createElement('div');
                el.setAttribute('class','ds-thread');
                el.setAttribute('data-thread-key', id);
                el.setAttribute('data-title',title);
                el.setAttribute('data-url', url);
                DUOSHUO.EmbedThread(el);
                jQuery(container).append(el);
            }
        </script>
        <a href="javascript:void(0);" onclick="toggleDuoshuoComments('#comment-box', 'urllibchu-tan', 'urllib初探' , 'http://www.lyon0804.com/urllibchu-tan.html');">
        查看评论</a>
        <div id="comment-box" ></div>
        <hr/>
    	<noscript>Please enable JavaScript to view the <a href="http://duoshuo.com/">comments powered by
        Duoshuo.</a></noscript>
    	<a href="http://duoshuo.com" class="dsq-brlink">comments powered by <span>Duoshuo</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
            <!-- <div class="list-group-item"> -->
            <!-- <h4> -->
            <!-- <i class="fa fa-home fa-lg"></i> -->
            <!-- <span class="icon-label">Social</span></h4> -->
              <ul class="list-group" id="social">
                   <!-- <li class="list-group-item"> -->
                   <div class="social-item">
                   <a href="http://github.com/lozybean">
                     <i class="fa fa-github-square fa-lg"></i><!--  github -->
                   </a>
                   </div>
                   <!-- </li> -->
                   <!-- <li class="list-group-item"> -->
                   <div class="social-item">
                   <a href="http://weibo.com/lyon0804">
                     <i class="fa fa-weibo fa-lg"></i><!--  weibo -->
                   </a>
                   </div>
                   <!-- </li> -->
              </ul>
            <!-- </div> -->
         <div class="col-xs-10">&copy; 2016 lyon
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3(modified by lyon)</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2" id="back-top">
            <!-- <p class="pull-right"><i class="fa fa-arrow-up"></i>  -->
            <a href="#top" title="回到顶部"></a>
            </p>
         </div>
      </div>
   </div>
</footer>
<script src="http://www.lyon0804.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.lyon0804.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.lyon0804.com/theme/js/respond.min.js"></script>


</body>
</html>